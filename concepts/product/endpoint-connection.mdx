---
title: "Endpoint Connection"
sidebarTitle: "Overview"
description: "A reusable connection to an external endpoint that defines how to connect to your AI system's API."
---

## What is an Endpoint Connection?

An Endpoint Connection tells Galtea how to call your AI system's API. You configure the URL, authentication, request format, and response mapping once, and Galtea uses it to run evaluations against your endpoint automatically.

<Note>
  Endpoint Connections are configured through the [Galtea Dashboard](https://platform.galtea.ai/) only — they are not currently accessible via the SDK.
</Note>

## Use Cases

- **Automate evaluations** — Galtea calls your endpoint directly for each test case, no manual inference needed
- **Standardize API calls** — Define reusable configurations with consistent auth and request formatting
- **Manage multiple environments** — Create separate connections for development, staging, and production

## Creating an Endpoint Connection

To create an Endpoint Connection:

1. Navigate to your product in the [Galtea Dashboard](https://platform.galtea.ai/)
2. Go to the "Endpoint Connections" section
3. Click "New Endpoint Connection"
4. Configure the connection properties as described below

  <video            
    autoPlay
    muted                                                                                                           
    loop
    playsInline                                                                                                     
    className="w-full aspect-video rounded-xl"                                                                    
    src="/videos/endpoint-connection-setup.mp4"
  ></video>

## Endpoint Connection Properties

<ResponseField name="Name" type="Text" required>
  A unique name for the endpoint connection within the product. **Example**: "Production Chat API" or "Staging Summarizer"
</ResponseField>

<ResponseField name="Type" type="Enum" required>
  A type that defines the purpose of the endpoint connection. Supported values:
  - `INITIALIZATION` - Connection used for initializing a session
  - `CONVERSATION` - Connection used for conversational interactions
  - `FINALIZATION` - Connection used for finalizing a session

  This is done for complex session lifecycles where a single endpoint connection is not enough.
</ResponseField>

<ResponseField name="URL" type="Text" required>
  The full URL of the endpoint to connect to. Must be a valid HTTP or HTTPS URL. **Example**: "https://api.company.com/v1/chat"
</ResponseField>

<ResponseField name="HTTP Method" type="Enum" required>
  The HTTP method to use when calling the endpoint. Supported values:
  - `GET`
  - `POST`
  - `PUT`
  - `PATCH`
  - `DELETE`
</ResponseField>

<ResponseField name="Auth Type" type="Enum" required>
  The authentication method to use. Supported values:
  - `NONE` - No authentication
  - `BEARER` - Bearer token authentication
  - `API_KEY` - API key authentication
  - `BASIC` - Basic HTTP authentication
</ResponseField>

<ResponseField name="Auth Token" type="Text">
  The authentication token or credentials, depending on the selected auth type. This value is securely stored.
</ResponseField>

<ResponseField name="Headers" type="JSON">
  Optional custom headers to include with each request. **Example**:
  ```json
  {
    "Content-Type": "application/json",
    "X-Custom-Header": "value"
  }
  ```
</ResponseField>

<ResponseField name="Input Template" type="String (Jinja2)" required>
  A Jinja2 template string defining how to format the request body. This template is rendered before sending the request to your endpoint.

  **Available placeholders:**
  - `{{ input }}` - The test case input (required)
  - `{{ context }}` - The test case context
  - `{{ session_id }}` - The external session ID (if available)
  - `{{ test_case_id }}` - The test case ID
  - `{{ test_id }}` - The test ID
  - `{{ galtea_session_id }}` - The Galtea session ID
  - `{{ inference_result_id }}` - The inference result ID for this turn (useful for [trace collection](/sdk/tutorials/tracing-agent-operations))
  - Any field stored in session metadata (for example `{{ sessionId }}`, `{{ tenant }}`, `{{ conversation_token }}`)
  - `{% for turn in past_turns %}...{% endfor %}` - Loop through conversation history
    - `{{ turn.input }}` - Previous user input
    - `{{ turn.output }}` - Previous assistant response

  **Example (OpenAI-compatible format)**:
  ```jinja2
  {
    "model": "gpt-4",
    "messages": [
      {"role": "system", "content": "You are a helpful assistant."},
      {% for turn in past_turns %}
      {"role": "user", "content": "{{ turn.input }}"},
      {"role": "assistant", "content": "{{ turn.output }}"},
      {% endfor %}
      {"role": "user", "content": "{{ input }}"}
    ]
  }
  ```

  **Example (Previous queries array)**:
  ```jinja2
  {
    "model": "gpt-4",
    "previous_queries": [
      {% for turn in past_turns %}
      "{{ turn.input }}"{% if not loop.last %},{% endif %}
      {% endfor %}
    ],
    "current_query": "{{ input }}"
  }
  ```

  <Note>
    When a loop is the **last item** in a JSON array, use `{% if not loop.last %},{% endif %}` after each iteration to prevent a trailing comma. When there's content **after** the loop (like in the OpenAI example above), trailing commas are valid and this pattern is not required.
  </Note>

  **Example (Custom format)**:
  ```jinja2
  {
    "data": {
      "names": ["query", "contexto"],
      "ndarray": [
        [
          "{{ input }}",
          [
            {% for turn in past_turns %}
            "{{ turn.input }}",
            "{{ turn.output }}"{% if not loop.last %},{% endif %}
            {% endfor %}
          ]
        ]
      ]
    }
  }
  ```
</ResponseField>

<ResponseField name="Output Mapping" type="JSON" required>
  A JSON object defining how to extract values from the API response using [JSONPath](https://goessner.net/articles/JsonPath/) expressions.

  **Required keys:**
  - `output` - JSONPath expression to extract the main response (required)

  **Optional keys:**
  - `retrieval_context` - JSONPath expression to extract retrieval context
  - Any additional keys for extra properties to store in session metadata

  **JSONPath Syntax Reference:**
  | Expression | Description |
  |------------|-------------|
  | `$` | Root object |
  | `.` | Child operator |
  | `[]` | Array index or child operator |
  | `[*]` | Wildcard (all elements) |
  | `[0]` | First array element |
  | `[-1]` | Last array element |

  **Example**:
  ```json
  {
    "output": "$.choices[0].message.content",
    "retrieval_context": "$.choices[0].retrieval_context",
    "session_id": "$.metadata.session_id"
  }
  ```
</ResponseField>

<ResponseField name="Timeout" type="Number">
  Request timeout in seconds. Must be between 1 and 300 seconds. Default: 30 seconds.
</ResponseField>

<ResponseField name="Rate Limit" type="Number">
  Optional rate limit for requests per minute. Use this to avoid exceeding your API's rate limits.
</ResponseField>

## Retry Configuration

Configure automatic retry behavior for failed requests. When enabled, Galtea will automatically retry requests that fail with specific HTTP status codes.

<ResponseField name="Retry Enabled" type="Boolean">
  Whether automatic retry is enabled. Default: `false`
</ResponseField>

<ResponseField name="Max Retry Attempts" type="Number">
  Maximum number of retry attempts. Default: `3`
</ResponseField>

<ResponseField name="Initial Delay" type="Number">
  Initial delay in milliseconds before the first retry. Default: `1000` (1 second)
</ResponseField>

<ResponseField name="Backoff Strategy" type="Enum">
  Strategy for increasing delay between retry attempts:
  - `exponential` - Delay doubles with each attempt (recommended)
  - `linear` - Delay increases linearly
  - `fixed` - Constant delay between attempts
  
  Default: `exponential`
</ResponseField>

<ResponseField name="Max Delay" type="Number">
  Maximum delay cap in milliseconds. Default: `30000` (30 seconds)
</ResponseField>

<ResponseField name="Retryable Status Codes" type="Array of Numbers">
  HTTP status codes that should trigger a retry. Default: `[429, 500, 502, 503, 504]`
</ResponseField>

## Best Practices

<AccordionGroup>
  <Accordion title="Use descriptive names">
    Choose names that clearly identify the endpoint's purpose and environment, such as "Production Chat API" or "Staging Document Analyzer".
  </Accordion>
  
  <Accordion title="Configure appropriate timeouts">
    Set timeouts based on your endpoint's expected response time. For complex AI operations, you may need longer timeouts (60-120 seconds).
  </Accordion>
  
  <Accordion title="Use retry configuration">
    Configure retries for endpoints that may experience transient failures. Start with 2-3 retries with exponential backoff.
  </Accordion>
  
  <Accordion title="Secure your credentials">
    Never share your auth tokens. Galtea securely stores and encrypts all authentication credentials.
  </Accordion>
</AccordionGroup>
